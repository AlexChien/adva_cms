<% content_for :filter do %>
  <% form_tag admin_articles_path, :method => 'get', :id => 'article_search' do -%>
    <label for="search" class="inline">
      <%=t :'adva.blog.titles.show_articles' %>
    </label>
    <select name="filter" id="filter_list">
      <%= options_for_select [[ t(:'adva.blog.options.filter.category'),  'category'],
                              [ t(:'adva.blog.options.filter.tags'),      'tags'],
                              [ t(:'adva.blog.options.filter.title'),     'title'],
                              [ t(:'adva.blog.options.filter.body'),      'body'],
                              [ t(:'adva.blog.options.filter.draft'),     'draft']], params[:filter] %>
    </select>
    <select name="category" id="categories">
      <option value="0"><%=t :'adva.categories.all' %></option>
      <%= options_from_collection_for_select @section.categories, :id, :title, params[:category].to_i %>
    </select>
    <%= text_field_tag 'query', params[:query], :id => 'query', :style => 'display: none' %>
    <input type="submit" id="button" value="Go" style="display: none" />
  <% end -%>
<% end -%>

<% content_for :sidebar do -%>
  <h3><%=t :'adva.blog.titles.manage'  %></h3>
  <ul>
    <li><%= link_to t(:'adva.blog.links.articles'), admin_articles_path(@site, @section) %></li>
    <li><%= link_to t(:'adva.blog.links.categories'), admin_categories_path(@site, @section) %></li>
    <li><%= link_to_edit(@section) %></li>
  </ul>

  <h3><%=t :'adva.blog.titles.actions' %></h3>
  <ul>
    <li><%= link_to_new [@section, :article] %></li>
  </ul>
<% end -%>

<%
	table_for @articles do |t|
		t.column :article, :comments, :published, :author, :actions

		t.head.row do |r|
			r.cell t(:'adva.articles.total_with_count', :count => @articles.total_entries), :class => :total, :colspan => :all
		end

		t.row do |r, article|
			r.cell link_to_edit(article.title, article, :class => article.state)
  		r.cell article.accept_comments? && !article.comments.empty? ? link_to(article.comments.size, admin_comments_path) : t(:"adva.common.none")
			r.cell published_at_formatted(article)
			r.cell link_to article.author_name, admin_site_user_path(@site, article.author)
			r.cell link_to_preview(article) + "\n" +
			       links_to_actions([:edit, :delete], article)
		end

		t.foot.row do |r|
			r.cell will_paginate(@articles), :class => :pagination, :colspan => :all
		end

		t.empty :p, :class => 'empty' do
			params[:filter] ?
				t(:'adva.blog.no_filtered_articles', :section => @section.title) :
				t(:'adva.blog.no_articles', :section => @section.title) + "\n" +
				link_to(t( :'adva.blog.links.create_article_now' ), new_admin_article_path(@site))
		end
	end
%>
